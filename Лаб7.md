# Задание

## 1. Составьте список запросов, которые отвечают за чтение данных

### Таблица операций чтения

| Функциональное требование                                                                                                                 | Ограниченные контексты | Агрегаты | Проекция |
|-------------------------------------------------------------------------------------------------------------------------------------------| --- | --- | --- |
| “Гость” может направить запрос в систему, существует ли уже пользователь с переданным никнеймом и получить ответ в формате “true”/”false” | **UM (User Management)** | **User** | **Проекция 1: Пользователи** |
| Пользователь может получить список всех своих проектов                                                                                    | **PM (Project Management)** | **Project** | **Проекция 2: Проекты пользователя** |
| Пользователь может получить все задачи в рамках выбранного проекта                                                                        | **TM (Task Management)**, **PM** | **Task**, **Project** | **Проекция 3: Задачи проекта** |
| Пользователь может увидеть все доступные статусы задач                                                                                    | **SM (Status Management)** | **Status** | **Проекция 4: Статусы задач** |
| Проверка использования статуса в задачах перед его удалением                                                                              | **TM**, **SM** | **Task**, **Status** | **Проекция 5: Использование статусов** |

---

## 2. Для каждой операции обозначьте список ограниченных контекстов, которые в ней задействованы
(См. таблицу выше)

## 3. Для каждой операции обозначьте список агрегатов, которые в ней задействованы
(См. таблицу выше)

---

## 4. Опишите проекции, которые могут помочь вам в обслуживании запросов

### Проекция 1: Пользователи

**Назначение**: Обслуживание запросов, связанных с проверкой наличия пользователей в системе.

| Таблица или коллекция | Атрибуты проекции | Агрегат |
| --- | --- | --- |
| **Users** | Все атрибуты сущности User, исключая пароль пользователя | **User** |

- **Описание**: Содержит все атрибуты сущности `User`, за исключением конфиденциальных данных (например, паролей).
- **Используется для**: Проверки уникальности никнейма, получения списка пользователей.

---

### Проекция 2: Проекты пользователя

**Назначение**: Обслуживание запросов, связанных со списком проектов для конкретного пользователя.

| Таблица или коллекция | Атрибуты проекции | Агрегат |
| --- | --- | --- |
| **UserProjects** | userId, projectId, projectName, description, createdAt | **Project** |
| **ProjectParticipants** | projectId, participantId, role | **User**, **Project** |

- **Описание**: Проекция агрегирует данные о проектах, в которых участвует пользователь, и их участниках.
- **Используется для**: Отображения всех проектов текущего пользователя.

---

### Проекция 3: Задачи проекта

**Назначение**: Обслуживание запросов по задачам, связанным с проектами.

| Таблица или коллекция | Атрибуты проекции | Агрегат |
| --- | --- | --- |
| **ProjectTasks** | taskId, projectId, taskName, statusId, assigneeId, dueDate | **Task** |
| **TaskStatus** | statusId, statusName | **Status** |

- **Описание**: Содержит информацию о задачах в разрезе проектов и текущих статусах.
- **Используется для**: Получения задач по проекту и фильтрации по статусу.

---

### Проекция 4: Статусы задач

**Назначение**: Обслуживание запросов, связанных с отображением и управлением статусами задач.

| Таблица или коллекция | Атрибуты проекции | Агрегат |
| --- | --- | --- |
| **AvailableStatuses** | statusId, statusName, color | **Status** |

- **Описание**: Содержит список всех возможных статусов задач.
- **Используется для**: Отображения доступных статусов в интерфейсе.

---

### Проекция 5: Использование статусов

**Назначение**: Обслуживание запросов для проверки использования статуса перед его удалением.

| Таблица или коллекция | Атрибуты проекции | Агрегат |
| --- | --- | --- |
| **StatusUsage** | statusId, projectId, taskCount | **Task**, **Status** |

- **Описание**: Проекция используется для проверки, есть ли задачи с данным статусом в проекте.
- **Используется для**: Проверки перед удалением статуса.

---

### API проекции проектов

Конечно, каждая из проекций будет иметь свой API. Но, поскольку данная проекция обслуживает достаточно большое количество разнообразных запросов (в моей реализации), я решил выделить для нее отдельную таблицу с пояснениями.

| Название               | Параметры                    | Описание                                              | Детали                                                                                   |
|------------------------|------------------------------|-------------------------------------------------------|------------------------------------------------------------------------------------------|
| **getProjectByID**     | `projectId`                 | Получение информации о проекте по его идентификатору  | Запрашивается проект из таблицы **UserProjects**, участники из **ProjectParticipants**   |
| **getUserProjects**    | `userId`                    | Получение списка проектов, в которых участвует пользователь | Извлекаются все проекты из таблицы **UserProjects**, где `userId` совпадает             |
| **getProjectTasks**    | `projectId`, `statusFilter` | Получение списка задач по проекту с фильтрацией по статусу | Данные из таблицы **ProjectTasks**, фильтр по `statusId`                                |
| **getTaskDetails**     | `taskId`                    | Получение детализированной информации по задаче       | Объединяются данные из **ProjectTasks** и **TaskStatus**                                |
| **getAvailableStatuses** | (нет параметров)          | Получение всех доступных статусов задач               | Извлекаются записи из таблицы **AvailableStatuses**                                     |
| **getStatusUsage**     | `statusId`, `projectId`     | Проверка использования статуса в задачах              | Подсчитывается количество задач из таблицы **StatusUsage** с указанным `statusId` и `projectId` |
| **getProjectsAnalytics** | `userId`, `dateRange`     | Получение аналитики по проектам пользователя за период | Собираются данные из таблиц **UserProjects** и **ProjectTasks** для отчетов             |

Первичный ключ для таблицы UserProjects — projectId.